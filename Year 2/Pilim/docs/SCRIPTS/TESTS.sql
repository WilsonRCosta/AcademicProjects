--Teste alinea (a)
GO 
SELECT*FROM TL51N_11.INFORMATION_SCHEMA.TABLES;

--Teste alinea (b)
GO
DROP TABLE Triplos
GO
DROP TABLE Posicao
GO
DROP TABLE Contacto_Telefonico
GO
DROP TABLE Contacto_Email
GO
DROP TABLE Contacto
GO
DROP TABLE Cliente
GO
DROP TABLE Registo
GO
DROP TABLE Instrumento_Financeiro
GO
DROP TABLE Valores_Mercado
GO
DROP TABLE Mercado_Financeiro


--Teste alinea (c)
GO
SELECT*FROM Triplos
GO
SELECT*FROM Posicao
GO
SELECT*FROM Contacto_Telefonico
GO
SELECT*FROM Contacto_Email
GO
SELECT*FROM Contacto
GO
SELECT*FROM Registo
GO
SELECT*FROM Instrumento_Financeiro
GO
SELECT*FROM Valores_Mercado


--Teste alinea (d)
GO
SELECT*FROM Cliente

--Teste alinea (e)
GO
SELECT*FROM Mercado_Financeiro

--Teste alinea (f)
GO
EXEC p_atualizaValorDiario
GO
SELECT*FROM Instrumento_Financeiro

--Teste alinea (g)
GO
SELECT Media6Meses from Instrumento_Financeiro

--Teste alinea (h)
SELECT*FROM Instrumento_Financeiro

--Teste alinea (i)
SELECT* FROM listar_portfolio('Description0')

--Teste alinea (j)
GO
INSERT INTO Triplos (Identificacao, Dia, Valor) VALUES
('IE00BXC8D038','2019-11-04 10:30:00', 889.53),
('FR0013340973','2019-11-04 10:30:00', 129.4),
('FR0004548873','2019-11-04 10:30:00', 89.14),
('US0111514983','2019-11-04 10:30:00', 562.53),
('US0253985401','2019-11-04 10:30:00', 814.09),
('IE00BXC8D038','2019-11-04 11:30:00', 352.05),
('FR0013340973','2019-11-04 11:30:00', 652.82),
('FR0004548873','2019-11-04 11:30:00', 665.89),
('US0111514983','2019-11-04 11:30:00', 980.55),
('US0253985401','2019-11-04 11:30:00', 869.64),
('IE00BXC8D038','2019-11-04 12:30:00', 379.92),
('FR0013340973','2019-11-04 12:30:00', 655.04),
('FR0004548873','2019-11-04 12:30:00', 255.87),
('US0111514983','2019-11-04 12:30:00', 187.27),
('US0253985401','2019-11-04 12:30:00', 822.54),
('IE00BXC8D038','2019-11-04 13:30:00', 438.72),
('FR0013340973','2019-11-04 13:30:00', 567.92),
('FR0004548873','2019-11-04 13:30:00', 751.68),
('US0111514983','2019-11-04 13:30:00', 47.95),
('US0253985401','2019-11-04 13:30:00', 399.66),
('IE00BXC8D038','2019-11-04 14:30:00', 823.25),
('FR0013340973','2019-11-04 14:30:00', 891.64),
('FR0004548873','2019-11-04 14:30:00', 846.25),
('US0111514983','2019-11-04 14:30:00', 836.58),
('US0253985401','2019-11-04 14:30:00', 131.69),
('IE00BXC8D038','2019-11-04 15:30:00', 972.94),
('FR0013340973','2019-11-04 15:30:00', 10.87),
('FR0004548873','2019-11-04 15:30:00', 220.61),
('US0111514983','2019-11-04 15:30:00', 95.36),
('US0253985401','2019-11-04 15:30:00', 116.8),
('IE00BXC8D038','2019-11-04 16:30:00', 726.22),
('FR0013340973','2019-11-04 16:30:00', 337.27),
('FR0004548873','2019-11-04 16:30:00', 705.46),
('US0111514983','2019-11-04 16:30:00', 243.87),
('US0253985401','2019-11-04 16:30:00', 366.87),
('IE00BXC8D038','2019-11-04 17:30:00', 880.75),
('FR0013340973','2019-11-04 17:30:00', 195.2),
('FR0004548873','2019-11-04 17:30:00', 974.81),
('US0111514983','2019-11-04 17:30:00', 630.24),
('US0253985401','2019-11-04 17:30:00', 283.52),
('IE00BXC8D038','2019-11-04 18:30:00', 59.21),
('FR0013340973','2019-11-04 18:30:00', 902.96),
('FR0004548873','2019-11-04 18:30:00', 254.53),
('US0111514983','2019-11-04 18:30:00', 616.03),
('US0253985401','2019-11-04 18:30:00', 349.52),
('IE00BXC8D038','2019-11-04 19:30:00', 73.14),
('FR0013340973','2019-11-04 19:30:00', 278.09),
('FR0004548873','2019-11-04 19:30:00', 218.41),
('US0111514983','2019-11-04 19:30:00', 243.44),
('US0253985401','2019-11-04 19:30:00', 78.09),
('IE00BXC8D038','2019-11-04 20:30:00', 154.2),
('FR0013340973','2019-11-04 20:30:00', 278.53),
('FR0004548873','2019-11-04 20:30:00', 842.96),
('US0111514983','2019-11-04 20:30:00', 42.82),
('US0253985401','2019-11-04 20:30:00', 833.87);
GO
EXEC p_actualizaValorDiario
GO
INSERT INTO Triplos (Identificacao, Dia, Valor) VALUES
('IE00BXC8D038','2019-11-04 21:30:00', 997.33),
('FR0013340973','2019-11-04 21:30:00', 149.75),
('FR0004548873','2019-11-04 21:30:00', 894.17),
('US0111514983','2019-11-04 21:30:00', 328.41),
('US0253985401','2019-11-04 21:30:00', 102.23);
GO
EXEC p_actualizaValorDiario


SELECT *from Instrumento_Financeiro

--Teste alinea (k)
GO
SELECT* FROM listar_portfolio('Description0')

--Teste alinea (l)
GO
SELECT* FROM resumo_portfolios
